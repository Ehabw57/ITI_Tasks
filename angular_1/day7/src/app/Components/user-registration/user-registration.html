<div class="row justify-content-center">
  <div class="col-md-6">
    <h3 class="text-center mb-0">Registration</h3>
    <form [formGroup]="registrationForm" (ngSubmit)="onSubmit()">
      <div class="mb-3">
        <label for="fullname" class="form-label">Full Name</label>
        <input
          type="text"
          class="form-control"
          id="fullname"
          formControlName="fullname"
          [ngClass]="{ 'is-invalid': fullname?.invalid && (fullname?.dirty || fullname?.touched) }"
          placeholder="Enter your full name"
        />

        @if(fullname?.dirty || fullname?.touched){
        <small class="text-danger">
          @if (fullname?.errors?.['required']) { Full name is required } @if
          (fullname?.errors?.['minlength']) { Full name must be at least 5 characters long }</small
        >
        }
      </div>

      <div class="mb-3">
        <label for="email" class="form-label">Email</label>
        <input
          type="email"
          class="form-control"
          id="email"
          formControlName="email"
          [ngClass]="{ 'is-invalid': email?.invalid && (email?.dirty || email?.touched) }"
          placeholder="Enter your email address"
        />

        @if (email?.invalid && (email?.dirty || email?.touched)) {
        <small class="text-danger">
          @if (email?.errors?.['required']) { Email is required } @if (email?.errors?.['email']) {
          Please enter a valid email address }
        </small>
        }
      </div>

      <div class="mb-3">
        <label for="password" class="form-label">Password</label>
        <input
          type="password"
          class="form-control"
          id="password"
          formControlName="password"
          placeholder="Enter your password"
          [ngClass]="{ 'is-invalid': password?.invalid && (password?.dirty || password?.touched) }"
        />

        @if (password?.invalid && (password?.dirty || password?.touched)) {
        <small class="text-danger">
          @if (password?.errors?.['required']) { Password is required } @if
          (password?.errors?.['minlength']) { Password must be at least 6 characters long }
        </small>
        }
      </div>

      <div class="mb-3">
        <label class="form-label">Mobile Numbers</label>
        <div formArrayName="phones">
          @for (phone of phones.controls; track $index) {
          <div [formGroupName]="$index" class="d-flex align-items-start gap-2">
            <div class="mb-3 flex-grow-1">
              <input
                type="tel"
                class="form-control"
                formControlName="number"
                [placeholder]="'Mobile number ' + ($index + 1)"
                [ngClass]="{
                  'is-invalid':
                    getPhoneControl($index)?.invalid &&
                    (getPhoneControl($index)?.dirty || getPhoneControl($index)?.touched)
                }"
              />

              @if (getPhoneControl($index)?.dirty || getPhoneControl($index)?.touched) {
              <small class="text-danger">
                @if (getPhoneControl($index)?.errors?.['required']) { Mobile number is required }
                @if (getPhoneControl($index)?.errors?.['pattern']) { Please enter a valid mobile
                number (10-15 digits) }
              </small>
              }
            </div>

            <button
              type="button"
              class="btn btn-outline-danger btn-sm"
              (click)="removePhoneNumber($index)"
            >
              X
            </button>
          </div>
          }

          <button
            type="button"
            class="btn btn-outline-primary btn-sm mt-2"
            (click)="addPhoneNumber()"
          >
            Add Another Mobile
          </button>
        </div>
      </div>

      <button type="submit" class="btn btn-primary btn-lg" [disabled]="registrationForm.invalid">
        Register
      </button>
    </form>
  </div>
</div>
